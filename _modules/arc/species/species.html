

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arc.species.species &mdash; ARC 1.1.0 Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> ARC
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../running.html">Running ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">ARCâ€™s API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools.html">Standalone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cite.html">How to cite ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../licence.html">Licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ARC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>arc.species.species</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arc.species.species</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># encoding: utf-8</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A module for representing stationary points (chemical species and transition states).</span>
<span class="sd">If the species is a transition state (TS), its ``ts_guesses`` attribute will have one or more ``TSGuess`` objects.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">arkane.common</span> <span class="k">import</span> <span class="n">ArkaneSpecies</span><span class="p">,</span> <span class="n">symbol_by_number</span>
<span class="kn">from</span> <span class="nn">arkane.statmech</span> <span class="k">import</span> <span class="n">determine_qm_software</span><span class="p">,</span> <span class="n">is_linear</span>
<span class="kn">from</span> <span class="nn">rmgpy.molecule.molecule</span> <span class="k">import</span> <span class="n">Atom</span><span class="p">,</span> <span class="n">Molecule</span>
<span class="kn">from</span> <span class="nn">rmgpy.reaction</span> <span class="k">import</span> <span class="n">Reaction</span>
<span class="kn">from</span> <span class="nn">rmgpy.species</span> <span class="k">import</span> <span class="n">Species</span>
<span class="kn">from</span> <span class="nn">rmgpy.statmech</span> <span class="k">import</span> <span class="n">NonlinearRotor</span><span class="p">,</span> <span class="n">LinearRotor</span>
<span class="kn">from</span> <span class="nn">rmgpy.molecule.resonance</span> <span class="k">import</span> <span class="n">generate_kekule_structure</span>
<span class="kn">from</span> <span class="nn">rmgpy.transport</span> <span class="k">import</span> <span class="n">TransportData</span>
<span class="kn">from</span> <span class="nn">rmgpy.exceptions</span> <span class="k">import</span> <span class="n">InvalidAdjacencyListError</span>

<span class="kn">from</span> <span class="nn">arc.common</span> <span class="k">import</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">get_atom_radius</span><span class="p">,</span> <span class="n">determine_symmetry</span>
<span class="kn">from</span> <span class="nn">arc.arc_exceptions</span> <span class="k">import</span> <span class="n">SpeciesError</span><span class="p">,</span> <span class="n">RotorError</span><span class="p">,</span> <span class="n">InputError</span><span class="p">,</span> <span class="n">TSError</span>
<span class="kn">from</span> <span class="nn">arc.settings</span> <span class="k">import</span> <span class="n">default_ts_methods</span><span class="p">,</span> <span class="n">valid_chars</span><span class="p">,</span> <span class="n">minimum_barrier</span>
<span class="kn">from</span> <span class="nn">arc.parser</span> <span class="k">import</span> <span class="n">parse_xyz_from_file</span><span class="p">,</span> <span class="n">parse_dipole_moment</span><span class="p">,</span> <span class="n">parse_polarizability</span><span class="p">,</span> <span class="n">process_conformers_file</span>
<span class="kn">from</span> <span class="nn">arc.species.converter</span> <span class="k">import</span> <span class="n">get_xyz_string</span><span class="p">,</span> <span class="n">get_xyz_matrix</span><span class="p">,</span> <span class="n">rdkit_conf_from_mol</span><span class="p">,</span> <span class="n">standardize_xyz_string</span><span class="p">,</span>\
    <span class="n">molecules_from_xyz</span><span class="p">,</span> <span class="n">rmg_mol_from_inchi</span><span class="p">,</span> <span class="n">order_atoms_in_mol_list</span><span class="p">,</span> <span class="n">check_isomorphism</span><span class="p">,</span> <span class="n">set_rdkit_dihedrals</span><span class="p">,</span>\
    <span class="n">translate_to_center_of_mass</span>
<span class="kn">from</span> <span class="nn">arc.species</span> <span class="k">import</span> <span class="n">conformers</span>
<span class="kn">from</span> <span class="nn">arc.ts</span> <span class="k">import</span> <span class="n">atst</span>

<span class="c1">##################################################################</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">()</span>


<div class="viewcode-block" id="ARCSpecies"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies">[docs]</a><span class="k">class</span> <span class="nc">ARCSpecies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for representing stationary points.</span>

<span class="sd">    Dictionary structure::</span>

<span class="sd">        rotors_dict: {1: {&#39;pivots&#39;: pivots_list,</span>
<span class="sd">                          &#39;top&#39;: top_list,</span>
<span class="sd">                          &#39;scan&#39;: scan_list,</span>
<span class="sd">                          &#39;success&#39;: ``bool``.</span>
<span class="sd">                          &#39;invalidation_reason&#39;: ``str``,</span>
<span class="sd">                          &#39;times_dihedral_set&#39;: ``int``,</span>
<span class="sd">                          &#39;scan_path&#39;: &lt;path to scan output file&gt;},</span>
<span class="sd">                          &#39;max_e&#39;: ``float``,  # in kJ/mol</span>
<span class="sd">                          &#39;symmetry&#39;: ``int``,</span>
<span class="sd">                      2: {}, ...</span>
<span class="sd">                     }</span>

<span class="sd">    Args:</span>
<span class="sd">        label (str, optional): The species label.</span>
<span class="sd">        is_ts (bool, optional): Whether or not the species represents a transition state.</span>
<span class="sd">        rmg_species (Species, optional): An RMG Species object to be converted to an ARCSpecies object.</span>
<span class="sd">        mol (Molecule, optional): An ``RMG Molecule`` object used for BAC determination.</span>
<span class="sd">                                  Atom order corresponds to the order in .initial_xyz</span>
<span class="sd">        xyz (str or list, optional): Entries are either string-format coordinates or file paths.</span>
<span class="sd">                                     (If there&#39;s only one entry, it could be given directly as a string, not in a list).</span>
<span class="sd">                                     The file paths could direct to either a .xyz file, ARC conformers</span>
<span class="sd">                                     (w/ or w/o energies), or an ESS log/input files.</span>
<span class="sd">        multiplicity (int, optional): The species&#39; multiplicity. Can be determined from the adjlist/smiles/xyz</span>
<span class="sd">                                      (the algorithm assumes it&#39;s either a singlet or a doublet).</span>
<span class="sd">        charge (int, optional): The species&#39; net charge. Assumed to be 0 be default.</span>
<span class="sd">        smiles (str, optional): A `SMILES &lt;https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system&gt;`_</span>
<span class="sd">                                representation for the species 2D graph.</span>
<span class="sd">        adjlist (str, optional): An `RMG adjacency list</span>
<span class="sd">                                 &lt;http://reactionmechanismgenerator.github.io/RMG-Py/reference/molecule/adjlist.html&gt;`_</span>
<span class="sd">                                 representation for the species 2D graph.</span>
<span class="sd">        inchi (str, optional): An `InChI &lt;https://www.inchi-trust.org/&gt;`_ representation for the species 2D graph.</span>
<span class="sd">        bond_corrections (dict, optional): The bond additivity corrections (BAC) to be used. Determined from the</span>
<span class="sd">                                           structure if not directly given.</span>
<span class="sd">        generate_thermo (bool, optional): Whether ot not to calculate thermodynamic properties for this species.</span>
<span class="sd">        species_dict (dict, optional): A dictionary to create this object from (used when restarting ARC).</span>
<span class="sd">        yml_path (str, optional): Path to an Arkane YAML file representing a species (for loading the object).</span>
<span class="sd">        ts_methods (list, optional): Methods to try for generating TS guesses. If Species is a TS and `ts_methods` is an</span>
<span class="sd">                                     empty list, then xyz (user guess) must be given. If `ts_methods` is None, it will</span>
<span class="sd">                                     be set to the default methods.</span>
<span class="sd">        ts_number (int, optional): An auto-generated number associating the TS ARCSpecies object with the corresponding</span>
<span class="sd">                                   :ref:`ARCReaction &lt;reaction&gt;` object.</span>
<span class="sd">        rxn_label (str, optional): The reaction string (relevant for TSs).</span>
<span class="sd">        external_symmetry (int, optional): The external symmetry of the species (not including rotor symmetries).</span>
<span class="sd">        optical_isomers (int, optional): Whether (=2) or not (=1) the species has chiral center/s.</span>
<span class="sd">        run_time (timedelta, optional): Overall species execution time.</span>
<span class="sd">        checkfile (str, optional): The local path to the latest checkfile by Gaussian for the species.</span>
<span class="sd">        number_of_radicals (int, optional): The number of radicals (inputted by the user, ARC won&#39;t attempt to determine</span>
<span class="sd">                                            it). Defaults to None. Important, e.g., if a Species is a bi-rad singlet,</span>
<span class="sd">                                            in which case the job should be unrestricted, but the multiplicity does not</span>
<span class="sd">                                            have the required information to make that decision (r vs. u).</span>
<span class="sd">        force_field (str, optional): The force field to be used for conformer screening. The default is MMFF94.</span>
<span class="sd">                                     Other optional force fields are MMFF94s, UFF, or GAFF (not recommended, slow).</span>
<span class="sd">                                     If &#39;fit&#39; is specified for this parameter, some initial MMFF94 conformers will be</span>
<span class="sd">                                     generated, then force field parameters will be fitted for this molecule and</span>
<span class="sd">                                     conformers will be re-run with the fitted force field (recommended for drug-like</span>
<span class="sd">                                     species and species with many heteroatoms). Another option is specifying &#39;cheap&#39;,</span>
<span class="sd">                                     and the &quot;old&quot; RDKit embedding method will be used.</span>
<span class="sd">        svpfit_output_file (str, optional): The path to a Gaussian output file of an SVP Fit job if previously ran</span>
<span class="sd">                                            (otherwise, this job will be spawned if running Gromacs).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        label (str): The species&#39; label.</span>
<span class="sd">        multiplicity (int): The species&#39; multiplicity. Can be determined from the adjlist/smiles/xyz</span>
<span class="sd">                            (the algorithm assumes it&#39;s either a singlet or a doublet).</span>
<span class="sd">        charge (int): The species&#39; net charge. Assumed to be 0 be default.</span>
<span class="sd">        number_of_radicals (int): The number of radicals (inputted by the user, ARC won&#39;t attempt to determine it).</span>
<span class="sd">                                  Defaults to None. Important, e.g., if a Species is a bi-rad singlet, in which case</span>
<span class="sd">                                  the job should be unrestricted, but the multiplicity does not have the required</span>
<span class="sd">                                  information to make that decision (r vs. u).</span>
<span class="sd">        e_elect (float): The total electronic energy (without ZPE) of the species at the chosen sp level, in kJ/mol.</span>
<span class="sd">        is_ts (bool):  Whether or not the species represents a transition state.</span>
<span class="sd">        number_of_rotors (int): The number of potential rotors to scan.</span>
<span class="sd">        rotors_dict (dict): A dictionary of rotors. structure given below.</span>
<span class="sd">        conformers (list): A list of selected conformers XYZs.</span>
<span class="sd">        conformer_energies (list): A list of conformers E0 (in kJ/mol).</span>
<span class="sd">        cheap_conformer (str): A string format xyz of a cheap conformer (not necessarily the best/lowest one).</span>
<span class="sd">        most_stable_conformer (str): A string format xyz of the best/lowest conformer ARC found.</span>
<span class="sd">        recent_md_conformer (list): A length three list containing the string format xyz of the recent conformer</span>
<span class="sd">                                    generated by MD, the energy in kJ/mol, and the number of MD runs. Used to detect</span>
<span class="sd">                                    when the MD algorithm converges on a single structure.</span>
<span class="sd">        svpfit_output_file (str): The path to a Gaussian output file of an SVP Fit job if previously ran</span>
<span class="sd">                                  (otherwise, this job will be spawned if running Gromacs).</span>
<span class="sd">        initial_xyz (str): The initial geometry guess.</span>
<span class="sd">        final_xyz (str): The optimized species geometry.</span>
<span class="sd">        radius (float): The species radius in Angstrom.</span>
<span class="sd">        opt_level (str): Level of theory for geometry optimization. Saved for archiving.</span>
<span class="sd">        number_of_atoms (int): The number of atoms in the species/TS.</span>
<span class="sd">        mol (Molecule): An ``RMG Molecule`` object used for BAC determination.</span>
<span class="sd">                        Atom order corresponds to the order in .initial_xyz</span>
<span class="sd">        mol_list (list): A list of localized structures generated from &#39;mol&#39;, if possible.</span>
<span class="sd">        rmg_species (Species): An RMG Species object to be converted to an ARCSpecies object.</span>
<span class="sd">        bond_corrections (dict): The bond additivity corrections (BAC) to be used. Determined from the structure</span>
<span class="sd">                                 if not directly given.</span>
<span class="sd">        run_time (timedelta): Overall species execution time.</span>
<span class="sd">        t1 (float): The T1 diagnostic parameter from Molpro.</span>
<span class="sd">        neg_freqs_trshed (list): A list of negative frequencies this species was troubleshooted for.</span>
<span class="sd">        generate_thermo (bool): Whether ot not to calculate thermodynamic properties for this species.</span>
<span class="sd">        thermo (HeatCapacityModel): The thermodata calculated by ARC.</span>
<span class="sd">        rmg_thermo (HeatCapacityModel): The thermodata generated by RMG for comparison.</span>
<span class="sd">        long_thermo_description (str): A description for the species entry in the thermo library outputed.</span>
<span class="sd">        ts_methods (list): Methods to try for generating TS guesses. If Species is a TS and `ts_methods` is an empty</span>
<span class="sd">                           list, then xyz (user guess) must be given. If `ts_methods` is None, it will be set to the</span>
<span class="sd">                           default methods.</span>
<span class="sd">        ts_guesses (list): A list of TSGuess objects for each of the specified methods.</span>
<span class="sd">        successful_methods (list): Methods used to generate a TS guess that successfully generated an XYZ guess.</span>
<span class="sd">        unsuccessful_methods (list): Methods used to generate a TS guess that were unsuccessfully.</span>
<span class="sd">        chosen_ts (int): The TSGuess index corresponding to the chosen TS conformer used for optimization.</span>
<span class="sd">        chosen_ts_method (str): The TS method that was actually used for optimization.</span>
<span class="sd">        ts_conf_spawned (bool): Whether conformers were already spawned for the Species (representing a TS) based on its</span>
<span class="sd">                                TSGuess objects.</span>
<span class="sd">        ts_number (int): An auto-generated number associating the TS ARCSpecies object with the corresponding</span>
<span class="sd">                         :ref:`ARCReaction &lt;reaction&gt;` object.</span>
<span class="sd">        ts_report (str): A description of all methods used for guessing a TS and their ranking.</span>
<span class="sd">        rxn_label (str): The reaction string (relevant for TSs).</span>
<span class="sd">        arkane_file (str): Path to the Arkane Species file generated in Processor.</span>
<span class="sd">        yml_path (str): Path to an Arkane YAML file representing a species (for loading the object).</span>
<span class="sd">        checkfile (str): The local path to the latest checkfile by Gaussian for the species.</span>
<span class="sd">        conformer_checkfiles (dict): A dictionary of conformer checkfiles. Keys are conformer indices,</span>
<span class="sd">                                     Values are local paths to check files.</span>
<span class="sd">        external_symmetry (int): The external symmetry of the species (not including rotor symmetries).</span>
<span class="sd">        optical_isomers (int): Whether (=2) or not (=1) the species has chiral center/s.</span>
<span class="sd">        transport_data (TransportData): A placeholder for updating transport properties after Lennard-Jones</span>
<span class="sd">                                        calculation (using OneDMin).</span>
<span class="sd">        force_field (str): The force field to be used for conformer screening. The default is MMFF94.</span>
<span class="sd">                           Other optional force fields are MMFF94s, UFF, or GAFF (not recommended, slow).</span>
<span class="sd">                           If &#39;fit&#39; is specified for this parameter, some initial MMFF94 conformers will be generated,</span>
<span class="sd">                           then force field parameters will be fitted for this molecule and conformers will be re-run</span>
<span class="sd">                           with the fitted force field (recommended for drug-like species and species with many</span>
<span class="sd">                           heteroatoms). Another option is specifying &#39;cheap&#39;, and the &quot;old&quot; RDKit embedding method</span>
<span class="sd">                           will be used.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_ts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rmg_species</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">smiles</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">adjlist</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inchi</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">bond_corrections</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generate_thermo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">species_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">yml_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ts_methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ts_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rxn_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">external_symmetry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">optical_isomers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">checkfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_radicals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_field</span><span class="o">=</span><span class="s1">&#39;MMFF94&#39;</span><span class="p">,</span>
                 <span class="n">svpfit_output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_number</span> <span class="o">=</span> <span class="n">ts_number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recent_md_conformer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conformer_energies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thermo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmg_thermo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmg_kinetics</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">mol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_radicals</span> <span class="o">=</span> <span class="n">number_of_radicals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="o">=</span> <span class="n">external_symmetry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="o">=</span> <span class="n">optical_isomers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span> <span class="o">=</span> <span class="n">run_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkfile</span> <span class="o">=</span> <span class="n">checkfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conformer_checkfiles</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport_data</span> <span class="o">=</span> <span class="n">TransportData</span><span class="p">()</span>
        <span class="n">smiles</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">,</span> <span class="n">inchi</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">smiles</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">adjlist</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">inchi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">species_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Reading from a dictionary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">species_dict</span><span class="o">=</span><span class="n">species_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Not reading from a dictionary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force_field</span> <span class="o">=</span> <span class="n">force_field</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span> <span class="o">=</span> <span class="n">is_ts</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_conf_spawned</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_elect</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arkane_file</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">svpfit_output_file</span> <span class="o">=</span> <span class="n">svpfit_output_file</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ts_methods</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="n">default_ts_methods</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="n">ts_methods</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user guess&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;ts_methods must be a list, got </span><span class="si">{0}</span><span class="s1"> of type </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rxn_label</span> <span class="o">=</span> <span class="n">rxn_label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successful_methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsuccessful_methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts_method</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span> <span class="o">=</span> <span class="n">generate_thermo</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">long_thermo_description</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opt_level</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span> <span class="o">=</span> <span class="n">yml_path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span> <span class="o">=</span> <span class="n">rmg_species</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bond_corrections</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="o">=</span> <span class="n">bond_corrections</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># a YAML path was given</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">from_yml_file</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># an RMG Species was given</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="p">,</span> <span class="n">Species</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;The rmg_species parameter has to be a valid RMG Species object.&#39;</span>
                                       <span class="s1">&#39; Got: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="p">)))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;If an RMG Species given, it must have a non-empty molecule list&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;If an RMG Species given, it must have a label or a label must be given&#39;</span>
                                       <span class="s1">&#39; separately&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">label</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">generate_resonance_structures</span><span class="p">(</span>
                            <span class="n">keep_isomorphic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Using localized structure </span><span class="si">{0}</span><span class="s1"> of species </span><span class="si">{1}</span><span class="s1"> for BAC determination. To use a&#39;</span>
                                    <span class="s1">&#39; different structure, pass the RMG:Molecule object in the `mol` parameter&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">toSMILES</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiplicity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_species</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getNetCharge</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
            <span class="k">if</span> <span class="n">multiplicity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span>
            <span class="k">if</span> <span class="n">charge</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">adjlist</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromAdjacencyList</span><span class="p">(</span><span class="n">adjlist</span><span class="o">=</span><span class="n">adjlist</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">inchi</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">rmg_mol_from_inchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">smiles</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">SMILES</span><span class="o">=</span><span class="n">smiles</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="c1"># Perceive molecule from xyz coordinates. This also populates mol and mol_list.</span>
                <span class="c1"># It overrides self.mol from adjlist or smiles so that xyz and mol have the same atom ordering.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol_from_xyz</span><span class="p">(</span><span class="n">get_cheap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No structure (SMILES, adjList, RMG:Species, or RMG:Molecule) was given for &#39;</span>
                                       <span class="s1">&#39; species </span><span class="si">{0}</span><span class="s1">, NOT using bond additivity corrections (BAC) for thermo &#39;</span>
                                       <span class="s1">&#39;computation.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Generate bond list for applying bond additivity corrections</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="o">=</span> <span class="n">enumerate_bonds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">long_thermo_description</span> <span class="o">+=</span> <span class="s1">&#39;Bond corrections: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mol_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="n">mol_copy</span><span class="o">.</span><span class="n">generate_resonance_structures</span><span class="p">(</span><span class="n">keep_isomorphic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Cannot determine bond additivity corrections (BAC) for species </span><span class="si">{0}</span><span class="s1"> based on xyz&#39;</span>
                               <span class="s1">&#39; coordinates only. For better thermoproperties, provide bond corrections.&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">neg_freqs_trshed</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">determine_multiplicity</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No multiplicity specified for </span><span class="si">{0}</span><span class="s1">, assuming </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No charge specified for </span><span class="si">{0}</span><span class="s1">, assuming charge 0.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Multiplicity for species </span><span class="si">{0}</span><span class="s1"> is lower than 1. Got: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Multiplicity for species </span><span class="si">{0}</span><span class="s1"> is not an integer. Got: </span><span class="si">{1}</span><span class="s1">, a </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Charge for species </span><span class="si">{0}</span><span class="s1"> is not an integer (got </span><span class="si">{1}</span><span class="s1">, a </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span>\
                <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;No structure (xyz, SMILES, adjList, RMG:Species, or RMG:Molecule) was given for&#39;</span>
                               <span class="s1">&#39; species </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;A label must be specified for an ARCSpecies object.&#39;</span><span class="p">)</span>
        <span class="c1"># Check that `label` is valid, since it is used for folder names</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_chars</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Species label </span><span class="si">{0}</span><span class="s1"> contains an invalid character: &quot;</span><span class="si">{1}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">char</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The number of atoms in the species&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span>

    <span class="nd">@number_of_atoms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">number_of_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow setting number of atoms, e.g. a TS might not have Molecule or xyz when initialized&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_atoms</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_heavy_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The number of heavy (non hydrogen) atoms in the species&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">isNonHydrogen</span><span class="p">()])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
                                                   <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ts_guess</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ts_guess</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="o">=</span>\
                            <span class="nb">len</span><span class="p">([</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ts_guess</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span>

    <span class="nd">@number_of_heavy_atoms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">number_of_heavy_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow setting number of heavy atoms, e.g. a TS might not have Molecule or xyz when initialized&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_heavy_atoms</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the largest distance from the coordinate system origin attributed to one of the molecule&#39;s</span>
<span class="sd">        atoms in 3D space. Units are Angstrom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">translated_xyz</span> <span class="o">=</span> <span class="n">translate_to_center_of_mass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">())</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="n">translated_xyz</span><span class="p">)</span>
            <span class="n">border_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># a list of the farthest element/s</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">si</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
                <span class="n">ri</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">yi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">zi</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">ri</span> <span class="o">==</span> <span class="n">r</span><span class="p">:</span>
                    <span class="n">border_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ri</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">:</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">ri</span>
                    <span class="n">border_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">si</span><span class="p">]</span>
            <span class="n">atom_r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">get_atom_radius</span><span class="p">(</span><span class="n">si</span><span class="p">)</span> <span class="k">if</span> <span class="n">get_atom_radius</span><span class="p">(</span><span class="n">si</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mf">1.50</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">border_elements</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">r</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">atom_r</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Determined a radius of </span><span class="si">{0:.2f}</span><span class="s1"> Angstrom for </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>

    <span class="nd">@radius</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allow setting the radius&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="ARCSpecies.as_dict"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A helper function for dumping this object as a dictionary in a YAML file for restarting ARC&quot;&quot;&quot;</span>
        <span class="n">species_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;force_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_field</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;is_ts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;E0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_elect</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;arkane_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arkane_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;yml_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_guesses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tsg</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">tsg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">]</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_conf_spawned&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_conf_spawned</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_number</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_report&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;rxn_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxn_label</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;successful_methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful_methods</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;unsuccessful_methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsuccessful_methods</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;chosen_ts_method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts_method</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;chosen_ts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;run_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t1</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;long_thermo_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_thermo_description</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;multiplicity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_radicals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;number_of_radicals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_radicals</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;charge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;generate_thermo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;opt_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_level</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;final_xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;number_of_rotors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;rotors_dict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;external_symmetry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;optical_isomers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span>
        <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;neg_freqs_trshed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neg_freqs_trshed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;bond_corrections&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">toAdjacencyList</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;initial_xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;checkfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkfile</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformer_checkfiles</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformer_checkfiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformer_checkfiles</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;most_stable_conformer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;cheap_conformer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_md_conformer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;recent_md_conformer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_md_conformer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">svpfit_output_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;svpfit_output_file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">svpfit_output_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">:</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span>
            <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformer_energies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformer_energies</span>
        <span class="k">return</span> <span class="n">species_dict</span></div>

<div class="viewcode-block" id="ARCSpecies.from_dict"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.from_dict">[docs]</a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper function for loading this object from a dictionary in a YAML file for restarting ARC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;All species must have a label&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;run_time&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;run_time&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;t1&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_elect</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;E electronic&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;E electronic&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arkane_file</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;arkane_file&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;arkane_file&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;yml_path&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;yml_path&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxn_label</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;rxn_label&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;rxn_label&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;radius&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;most_stable_conformer&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;most_stable_conformer&#39;</span>\
                                                                              <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;cheap_conformer&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;cheap_conformer&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recent_md_conformer</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;recent_md_conformer&#39;</span><span class="p">]</span>\
            <span class="k">if</span> <span class="s1">&#39;recent_md_conformer&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_field</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;force_field&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;force_field&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="s1">&#39;MMFF94&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">svpfit_output_file</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;svpfit_output_file&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;svpfit_output_file&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long_thermo_description</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;long_thermo_description&#39;</span><span class="p">]</span>\
            <span class="k">if</span> <span class="s1">&#39;long_thermo_description&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="o">=</span> <span class="n">standardize_xyz_string</span><span class="p">(</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;initial_xyz&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;initial_xyz&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span>\
            <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="o">=</span> <span class="n">standardize_xyz_string</span><span class="p">(</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;final_xyz&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;final_xyz&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;is_ts&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;is_ts&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_conf_spawned</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_conf_spawned&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ts_conf_spawned&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_number</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_number&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ts_number&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_report&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ts_report&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">ts_methods</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_methods&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ts_methods&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">ts_methods</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="n">default_ts_methods</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="n">ts_methods</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user guess&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;ts_methods must be a list, got </span><span class="si">{0}</span><span class="s1"> of type </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ts_methods</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span> <span class="o">=</span> <span class="p">[</span><span class="n">TSGuess</span><span class="p">(</span><span class="n">ts_dict</span><span class="o">=</span><span class="n">tsg</span><span class="p">)</span> <span class="k">for</span> <span class="n">tsg</span> <span class="ow">in</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;ts_guesses&#39;</span><span class="p">]]</span>\
                <span class="k">if</span> <span class="s1">&#39;ts_guesses&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">successful_methods</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;successful_methods&#39;</span><span class="p">]</span>\
                <span class="k">if</span> <span class="s1">&#39;successful_methods&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsuccessful_methods</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;unsuccessful_methods&#39;</span><span class="p">]</span>\
                <span class="k">if</span> <span class="s1">&#39;unsuccessful_methods&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts_method</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;chosen_ts_method&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;chosen_ts_method&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;chosen_ts&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;chosen_ts&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkfile</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;checkfile&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;checkfile&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conformer_checkfiles</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformer_checkfiles&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;conformer_checkfiles&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span>\
                <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_methods</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s1">&#39;xyz&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_xyz</span><span class="p">(</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_chars</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Species label </span><span class="si">{0}</span><span class="s1"> contains an invalid character: &quot;</span><span class="si">{1}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">char</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;multiplicity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;multiplicity&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;charge&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;charge&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;charge&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">species_dict</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No charge specified for </span><span class="si">{0}</span><span class="s1">, assuming charge 0.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_thermo</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;generate_thermo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;generate_thermo&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_radicals</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;number_of_radicals&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;number_of_radicals&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_level</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;opt_level&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;opt_level&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;number_of_rotors&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;number_of_rotors&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;rotors_dict&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;rotors_dict&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;external_symmetry&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;external_symmetry&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;optical_isomers&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;optical_isomers&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neg_freqs_trshed</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;neg_freqs_trshed&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;neg_freqs_trshed&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;bond_corrections&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;bond_corrections&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromAdjacencyList</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]))</span> <span class="k">if</span> <span class="s1">&#39;mol&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">InvalidAdjacencyListError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Could not read RMG adjacency list </span><span class="si">{0}</span><span class="s1">. Got:</span><span class="se">\n</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;mol&#39;</span>
                                                                                   <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                                                                   <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;smiles&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">inchi</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;inchi&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;inchi&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">adjlist</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;adjlist&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;adjlist&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">adjlist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromAdjacencyList</span><span class="p">(</span><span class="n">adjlist</span><span class="o">=</span><span class="n">adjlist</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">inchi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">rmg_mol_from_inchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">smiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">SMILES</span><span class="o">=</span><span class="n">smiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol_from_xyz</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;bond_corrections&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">species_dict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span> <span class="o">=</span> <span class="n">enumerate_bonds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">long_thermo_description</span> <span class="o">+=</span> <span class="s1">&#39;Bond corrections: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_corrections</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">getNetCharge</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">generate_resonance_structures</span><span class="p">(</span><span class="n">keep_isomorphic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                                           <span class="n">filter_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;conformers&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformers&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conformer_energies</span> <span class="o">=</span> <span class="n">species_dict</span><span class="p">[</span><span class="s1">&#39;conformer_energies&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;conformer_energies&#39;</span> <span class="ow">in</span> <span class="n">species_dict</span>\
                <span class="k">else</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span>\
                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">tsg</span><span class="o">.</span><span class="n">xyz</span> <span class="k">for</span> <span class="n">tsg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">]):</span>
            <span class="c1"># TS species are allowed to be loaded w/o a structure</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Must have either mol or xyz for species </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span></div>

<div class="viewcode-block" id="ARCSpecies.from_yml_file"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.from_yml_file">[docs]</a>    <span class="k">def</span> <span class="nf">from_yml_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load important species attributes such as label and final_xyz from the Arkane YAML file</span>
<span class="sd">        Actual QM data parsing is done later when processing thermo and kinetics</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rmg_spc</span> <span class="o">=</span> <span class="n">Species</span><span class="p">()</span>
        <span class="n">arkane_spc</span> <span class="o">=</span> <span class="n">ArkaneSpecies</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">rmg_spc</span><span class="p">)</span>
        <span class="c1"># The data from the YAML file is loaded into the `species` argument of the `load_yaml` method in Arkane</span>
        <span class="n">arkane_spc</span><span class="o">.</span><span class="n">load_yaml</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yml_path</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">pdep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="o">=</span> <span class="n">get_xyz_string</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                        <span class="n">numbers</span><span class="o">=</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">adjacency_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromAdjacencyList</span><span class="p">(</span><span class="n">adjlist</span><span class="o">=</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">adjacency_list</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Could not read adjlist:</span><span class="se">\n</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">adjacency_list</span><span class="p">))</span>  <span class="c1"># should *not* be logging</span>
                <span class="k">raise</span>
        <span class="k">elif</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">inchi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromInChI</span><span class="p">(</span><span class="n">inchistr</span><span class="o">=</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">inchi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">smiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromSMILES</span><span class="p">(</span><span class="n">arkane_spc</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">generate_resonance_structures</span><span class="p">(</span><span class="n">keep_isomorphic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">getNetCharge</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">spinMultiplicity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="o">=</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">opticalIsomers</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">external_symmetry_mode</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">modes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">(</span><span class="n">NonlinearRotor</span><span class="p">,</span> <span class="n">LinearRotor</span><span class="p">)):</span>
                    <span class="n">external_symmetry_mode</span> <span class="o">=</span> <span class="n">mode</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">external_symmetry_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="o">=</span> <span class="n">external_symmetry_mode</span><span class="o">.</span><span class="n">symmetry</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol_from_xyz</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_elect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># TODO: this is actually the E0, not e_elect! be consistent!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_elect</span> <span class="o">=</span> <span class="n">arkane_spc</span><span class="o">.</span><span class="n">conformer</span><span class="o">.</span><span class="n">E0</span><span class="o">.</span><span class="n">value_si</span> <span class="o">*</span> <span class="mf">0.001</span>  <span class="c1"># convert to kJ/mol</span></div>

<div class="viewcode-block" id="ARCSpecies.generate_conformers"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.generate_conformers">[docs]</a>    <span class="k">def</span> <span class="nf">generate_conformers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confs_to_dft</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plot_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate conformers</span>

<span class="sd">        Args:</span>
<span class="sd">            confs_to_dft (int, optional): The number of conformers to store in the .conformers attribute of the species</span>
<span class="sd">                                          that will later be DFT&#39;ed at the conformers_level.</span>
<span class="sd">            plot_path (str, optional): A folder path in which the plot will be saved.</span>
<span class="sd">                                                If None, the plot will not be shown (nor saved).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">:</span>
                <span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mol_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">]</span>
            <span class="n">lowest_confs</span> <span class="o">=</span> <span class="n">conformers</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">(</span><span class="n">mol_list</span><span class="o">=</span><span class="n">mol_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                                                          <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span>
                                                          <span class="n">force_field</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">force_field</span><span class="p">,</span> <span class="n">print_logs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                          <span class="n">num_confs_to_return</span><span class="o">=</span><span class="n">confs_to_dft</span><span class="p">,</span> <span class="n">return_all_conformers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                          <span class="n">plot_path</span><span class="o">=</span><span class="n">plot_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">conf</span> <span class="ow">in</span> <span class="n">lowest_confs</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conformer_energies</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lowest_confs</span><span class="p">))</span>
            <span class="n">lowest_conf</span> <span class="o">=</span> <span class="n">conformers</span><span class="o">.</span><span class="n">get_lowest_confs</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">confs</span><span class="o">=</span><span class="n">lowest_confs</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Most stable force field conformer for </span><span class="si">{0}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">lowest_conf</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="ARCSpecies.get_cheap_conformer"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.get_cheap_conformer">[docs]</a>    <span class="k">def</span> <span class="nf">get_cheap_conformer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cheaply (limiting the number of possible conformers) get a reasonable conformer,</span>
<span class="sd">        this could very well not be the best (lowest) one.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A reasonable conformer&#39;s xyz coordinates in string format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_confs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">rd_mol</span><span class="p">,</span> <span class="n">rd_index_map</span> <span class="o">=</span> <span class="n">conformers</span><span class="o">.</span><span class="n">embed_rdkit</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">num_confs</span><span class="o">=</span><span class="n">num_confs</span><span class="p">)</span>
        <span class="n">xyzs</span><span class="p">,</span> <span class="n">energies</span> <span class="o">=</span> <span class="n">conformers</span><span class="o">.</span><span class="n">rdkit_force_field</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">rd_mol</span><span class="o">=</span><span class="n">rd_mol</span><span class="p">,</span> <span class="n">rd_index_map</span><span class="o">=</span><span class="n">rd_index_map</span><span class="p">,</span>
                                                      <span class="n">mol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">force_field</span><span class="o">=</span><span class="s1">&#39;MMFF94&#39;</span><span class="p">,</span> <span class="n">return_xyz_strings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">energies</span><span class="p">:</span>
            <span class="n">min_energy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span>
            <span class="n">min_energy_index</span> <span class="o">=</span> <span class="n">energies</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">min_energy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="o">=</span> <span class="n">xyzs</span><span class="p">[</span><span class="n">min_energy_index</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">xyzs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="o">=</span> <span class="n">xyzs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Could not generate a cheap conformer for </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ARCSpecies.get_xyz"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.get_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">get_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_cheap</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the highest quality xyz the species has. If it doesn&#39;t have any 3D information, cheaply generate it.</span>

<span class="sd">        Args:</span>
<span class="sd">            get_cheap (bool, optional): Whether to get a cheap FF conformer if no xyz is found. True to get.</span>

<span class="sd">        Return:</span>
<span class="sd">             str: A string-format xyz coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">most_stable_conformer</span> <span class="ow">or</span> <span class="n">conf</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span>
        <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ts_guess</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ts_guess</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">xyz</span> <span class="o">=</span> <span class="n">ts_guess</span><span class="o">.</span><span class="n">xyz</span>
                        <span class="k">return</span> <span class="n">xyz</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">):</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">get_cheap</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_cheap_conformer</span><span class="p">()</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cheap_conformer</span>
        <span class="k">return</span> <span class="n">xyz</span></div>

<div class="viewcode-block" id="ARCSpecies.determine_rotors"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.determine_rotors">[docs]</a>    <span class="k">def</span> <span class="nf">determine_rotors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine possible unique rotors in the species to be treated as hindered rotors,</span>
<span class="sd">        taking into account all localized structures.</span>
<span class="sd">        The resulting rotors are saved in {&#39;pivots&#39;: [1, 3], &#39;top&#39;: [3, 7], &#39;scan&#39;: [2, 1, 3, 7]} format</span>
<span class="sd">        in self.species_dict[species.label][&#39;rotors_dict&#39;]. Also updates &#39;number_of_rotors&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">:</span>
                <span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mol_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mol_list</span><span class="p">:</span>
                <span class="n">rotors</span> <span class="o">=</span> <span class="n">conformers</span><span class="o">.</span><span class="n">find_internal_rotors</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">new_rotor</span> <span class="ow">in</span> <span class="n">rotors</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">existing_rotor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">existing_rotor</span><span class="p">[</span><span class="s1">&#39;pivots&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_rotor</span><span class="p">[</span><span class="s1">&#39;pivots&#39;</span><span class="p">]:</span>
                            <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_rotor</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Found one possible rotor for </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Found </span><span class="si">{0}</span><span class="s1"> possible rotors for </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Pivot list(s) for </span><span class="si">{0}</span><span class="s1">: </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;pivots&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_rotors</span><span class="p">)]))</span></div>

<div class="viewcode-block" id="ARCSpecies.set_dihedral"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.set_dihedral">[docs]</a>    <span class="k">def</span> <span class="nf">set_dihedral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pivots</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">deg_increment</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generated an RDKit molecule object from the given self.final_xyz.</span>
<span class="sd">        Increments the current dihedral angle between atoms i, j, k, l in the `scan` list by &#39;deg_increment` in degrees.</span>
<span class="sd">        All bonded atoms are moved accordingly. The result is saved in self.initial_xyz.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">deg_increment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;set_dihedral was called with zero increment for </span><span class="si">{label}</span><span class="s1"> with pivots </span><span class="si">{pivots}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">pivots</span><span class="o">=</span><span class="n">pivots</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">rotor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>  <span class="c1"># penalize this rotor to avoid inf. looping</span>
                <span class="k">if</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;pivots&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pivots</span><span class="p">:</span>
                    <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;times_dihedral_set&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rotor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;pivots&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pivots</span> <span class="ow">and</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;times_dihedral_set&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;times_dihedral_set&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rotor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Rotor </span><span class="si">{i}</span><span class="s1"> with pivots </span><span class="si">{pivots}</span><span class="s1"> was set </span><span class="si">{times}</span><span class="s1"> times&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">pivots</span><span class="o">=</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;pivots&#39;</span><span class="p">],</span> <span class="n">times</span><span class="o">=</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;times_dihedral_set&#39;</span><span class="p">]))</span>
                <span class="k">raise</span> <span class="n">RotorError</span><span class="p">(</span><span class="s1">&#39;Rotors were set beyond the maximal number of times without converging&#39;</span><span class="p">)</span>
            <span class="n">coordinates</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span><span class="p">)</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">molecules_from_xyz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_xyz</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">conf</span><span class="p">,</span> <span class="n">rd_mol</span><span class="p">,</span> <span class="n">indx_map</span> <span class="o">=</span> <span class="n">rdkit_conf_from_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
            <span class="n">rd_scan</span> <span class="o">=</span> <span class="p">[</span><span class="n">indx_map</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan</span><span class="p">]</span>  <span class="c1"># convert the atom indices in `scan` to RDKit indices</span>
            <span class="n">new_xyz</span> <span class="o">=</span> <span class="n">set_rdkit_dihedrals</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">rd_mol</span><span class="p">,</span> <span class="n">indx_map</span><span class="p">,</span> <span class="n">rd_scan</span><span class="p">,</span> <span class="n">deg_increment</span><span class="o">=</span><span class="n">deg_increment</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_xyz</span> <span class="o">=</span> <span class="n">get_xyz_string</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">new_xyz</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">atoms</span><span class="p">)</span></div>

<div class="viewcode-block" id="ARCSpecies.determine_symmetry"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.determine_symmetry">[docs]</a>    <span class="k">def</span> <span class="nf">determine_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine external symmetry and chirality (optical isomers) of the species</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
            <span class="n">coords</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
            <span class="n">symmetry</span><span class="p">,</span> <span class="n">optical_isomers</span> <span class="o">=</span> <span class="n">determine_symmetry</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">symbols</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">optical_isomers</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span> <span class="o">!=</span> <span class="n">optical_isomers</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;User input of optical isomers for </span><span class="si">{0}</span><span class="s2"> and ARC&#39;s calculation differ: </span><span class="si">{1}</span><span class="s2"> and </span><span class="si">{2}</span><span class="s2">,&quot;</span>
                               <span class="s2">&quot; respectively. Using the user input of </span><span class="si">{1}</span><span class="s2">&quot;</span>
                               <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_isomers</span><span class="p">,</span> <span class="n">optical_isomers</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">symmetry</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span> <span class="o">!=</span> <span class="n">symmetry</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;User input of external symmetry for </span><span class="si">{0}</span><span class="s2"> and ARC&#39;s calculation differ: </span><span class="si">{1}</span><span class="s2"> and </span><span class="si">{2}</span><span class="s2">,&quot;</span>
                               <span class="s2">&quot; respectively. Using the user input of </span><span class="si">{1}</span><span class="s2">&quot;</span>
                               <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_symmetry</span><span class="p">,</span> <span class="n">symmetry</span><span class="p">))</span></div>

<div class="viewcode-block" id="ARCSpecies.determine_multiplicity"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.determine_multiplicity">[docs]</a>    <span class="k">def</span> <span class="nf">determine_multiplicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the spin multiplicity of the species</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
        <span class="k">elif</span> <span class="n">adjlist</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span><span class="o">.</span><span class="n">fromAdjacencyList</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">adjlist</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
        <span class="k">elif</span> <span class="n">smiles</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">SMILES</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">smiles</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">multiplicity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">):</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">xyz</span><span class="p">:</span>
                <span class="n">atoms</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">electrons</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbol_by_number</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">atom</span><span class="p">:</span>
                            <span class="n">electrons</span> <span class="o">+=</span> <span class="n">number</span>
                            <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Could not identify atom symbol </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atom</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">electrons</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">2</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Multiplicity not specified for </span><span class="si">{0}</span><span class="s1">, assuming a value of 2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Multiplicity not specified for </span><span class="si">{0}</span><span class="s1">, assuming a value of 1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Could not determine multiplicity for species </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span></div>

<div class="viewcode-block" id="ARCSpecies.make_ts_report"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.make_ts_report">[docs]</a>    <span class="k">def</span> <span class="nf">make_ts_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A helper function to write content into the .ts_report attribute&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="s1">&#39;TS method summary for </span><span class="si">{0}</span><span class="s1"> in </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxn_label</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="s1">&#39;Methods that successfully generated a TS guess:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful_methods</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">successful_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">successful_methods</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="n">successful_method</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsuccessful_methods</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Methods that were unsuccessfully in generating a TS guess:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">unsuccessful_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsuccessful_methods</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="n">unsuccessful_method</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts_report</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The method that generated the best TS guess and its output used for the&#39;</span> \
                              <span class="s1">&#39; optimization: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chosen_ts_method</span><span class="p">)</span></div>

<div class="viewcode-block" id="ARCSpecies.mol_from_xyz"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.mol_from_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">mol_from_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_cheap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make sure atom order in self.mol corresponds to xyz</span>
<span class="sd">        Important for TS discovery and for identifying rotor indices</span>

<span class="sd">        This works by generating a molecule from the xyz and using the</span>
<span class="sd">        2D structure to confirm that the perceived molecule is correct.</span>
<span class="sd">        Resonance structures are generated and saved to ``self.mol_list``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">(</span><span class="n">get_cheap</span><span class="o">=</span><span class="n">get_cheap</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># self.mol should have come from another source, e.g. SMILES or yml</span>
            <span class="n">original_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">molecules_from_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">check_isomorphism</span><span class="p">(</span><span class="n">original_mol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;XYZ and the 2D graph representation of the Molecule are not isomorphic.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                 <span class="s1">&#39;Got xyz:</span><span class="se">\n</span><span class="si">{0}</span><span class="se">\n\n</span><span class="s1">which corresponds to </span><span class="si">{1}</span><span class="se">\n</span><span class="si">{2}</span><span class="se">\n\n</span><span class="s1">and: </span><span class="si">{3}</span><span class="se">\n</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                   <span class="n">xyz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">toSMILES</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">toAdjacencyList</span><span class="p">(),</span>
                                   <span class="n">original_mol</span><span class="o">.</span><span class="n">toSMILES</span><span class="p">(),</span> <span class="n">original_mol</span><span class="o">.</span><span class="n">toAdjacencyList</span><span class="p">()))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">original_mol</span>  <span class="c1"># todo: Atom order will not be correct, need fix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="o">=</span> <span class="n">molecules_from_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Assign atom ids first, so they carry through to the resonance structures</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">assignAtomIDs</span><span class="p">()</span>
            <span class="c1"># The generate_resonance_structures method changes atom order</span>
            <span class="c1"># Make a copy so we don&#39;t disturb the original order from xyz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">generate_resonance_structures</span><span class="p">(</span><span class="n">keep_isomorphic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                                                   <span class="n">filter_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">order_atoms_in_mol_list</span><span class="p">(</span><span class="n">ref_mol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mol</span><span class="p">,</span> <span class="n">mol_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mol_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ARCSpecies.process_xyz"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.process_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">process_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process the user&#39;s input and add either to the .conformers attribute or to .ts_guesses.</span>

<span class="sd">        Args:</span>
<span class="sd">            xyz_list (list, str): Entries are either string-format coordinates or file paths.</span>
<span class="sd">                                  (If there&#39;s only one entry, it could be given directly, not in a list)</span>
<span class="sd">                                  The file paths could direct to either a .xyz file, ARC conformers (w/ or w/o</span>
<span class="sd">                                  energies), or an ESS log/input files, making this method extremely flexible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xyz_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xyz_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">xyz_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">xyz_list</span><span class="p">]</span>
            <span class="n">xyzs</span><span class="p">,</span> <span class="n">energies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">xyz</span> <span class="ow">in</span> <span class="n">xyz_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;each xyz entry in xyz_list must be a string. &#39;</span>
                                     <span class="s1">&#39;Got:</span><span class="se">\n</span><span class="si">{0}</span><span class="se">\n</span><span class="s1">which is a </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">xyz</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
                    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s1">&#39;txt&#39;</span> <span class="ow">in</span> <span class="n">file_extension</span><span class="p">:</span>
                        <span class="c1"># assume this is an ARC conformer file</span>
                        <span class="n">xyzs_</span><span class="p">,</span> <span class="n">energies_</span> <span class="o">=</span> <span class="n">process_conformers_file</span><span class="p">(</span><span class="n">conformers_path</span><span class="o">=</span><span class="n">xyz</span><span class="p">)</span>
                        <span class="n">xyzs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xyzs_</span><span class="p">)</span>
                        <span class="n">energies</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">energies_</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># assume this is an ESS log file</span>
                        <span class="n">xyzs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parse_xyz_from_file</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>  <span class="c1"># also calls standardize_xyz_string()</span>
                        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># dummy (lists should be the same length)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># assume this is a string format xyz</span>
                    <span class="n">xyzs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardize_xyz_string</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>
                    <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># dummy (lists should be the same length)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conformers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xyzs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conformer_energies</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tsg_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xyzs</span><span class="p">,</span> <span class="n">energies</span><span class="p">):</span>
                    <span class="c1"># make TSGuess objects</span>
                    <span class="c1"># for tsg in self.ts_guesses:</span>
                    <span class="c1">#     if xyz == tsg.xyz:</span>
                    <span class="c1">#         break</span>
                    <span class="c1"># else:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TSGuess</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;user guess </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tsg_index</span><span class="p">),</span> <span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">))</span>
                    <span class="c1"># user guesses are always successful in generating a *guess*:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ts_guesses</span><span class="p">[</span><span class="n">tsg_index</span><span class="p">]</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">tsg_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">xyz</span> <span class="ow">in</span> <span class="n">xyzs</span><span class="p">:</span>
                    <span class="n">consistent</span> <span class="o">=</span> <span class="n">check_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">consistent</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">SpeciesError</span><span class="p">(</span><span class="s1">&#39;Inconsistent combination of number of electrons. multiplicity and charde  &#39;</span>
                                           <span class="s1">&#39;for </span><span class="si">{0}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span></div>

<div class="viewcode-block" id="ARCSpecies.set_transport_data"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.ARCSpecies.set_transport_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_transport_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lj_path</span><span class="p">,</span> <span class="n">opt_path</span><span class="p">,</span> <span class="n">bath_gas</span><span class="p">,</span> <span class="n">opt_level</span><span class="p">,</span> <span class="n">freq_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">freq_level</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the species.transport_data attribute after a Lennard-Jones calculation (via OneDMin)</span>
<span class="sd">        `lj_path` is the path to a oneDMin job output file</span>
<span class="sd">        `opt_path` is the path to an opt job output file</span>
<span class="sd">        `bath_gas` is the oneDMin job bath gas</span>
<span class="sd">        `opt_level` is the optimization level of theory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">original_comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport_data</span><span class="o">.</span><span class="n">comment</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;L-J coefficients calculated by OneDMin using a DF-MP2/aug-cc-pVDZ potential energy surface &#39;</span> \
                  <span class="s1">&#39;with </span><span class="si">{0}</span><span class="s1"> as the bath gas&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bath_gas</span><span class="p">)</span>
        <span class="n">epsilon</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lj_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Epsilons[1/cm]&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># Conversion of cm^-1 to J/mol (see https://cccbdb.nist.gov/wavenumber.asp)</span>
                <span class="n">epsilon</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">11.96266</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;J/mol&#39;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="s1">&#39;Sigmas[angstrom]&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># Convert Angstroms to meters</span>
                <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_atoms</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; The molecule is monoatomic&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_linear</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
                <span class="n">shape_index</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; The molecule is linear&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shape_index</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_atoms</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dipole_moment</span> <span class="o">=</span> <span class="n">parse_dipole_moment</span><span class="p">(</span><span class="n">opt_path</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">dipole_moment</span><span class="p">:</span>
                <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; Dipole moment was calculated at the </span><span class="si">{0}</span><span class="s1"> level of theory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt_level</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dipole_moment</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transport_data</span><span class="o">.</span><span class="n">polarizability</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;angstroms^3&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">freq_path</span><span class="p">:</span>
            <span class="n">polar</span> <span class="o">=</span> <span class="p">(</span><span class="n">parse_polarizability</span><span class="p">(</span><span class="n">freq_path</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;angstroms^3&#39;</span><span class="p">))</span>
            <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; Polarizability was calculated at the </span><span class="si">{0}</span><span class="s1"> level of theory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">freq_level</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; Rotational Relaxation Collision Number was not determined, default value is 2&#39;</span>
        <span class="k">if</span> <span class="n">original_comment</span><span class="p">:</span>
            <span class="n">comment</span> <span class="o">+=</span> <span class="s1">&#39;; &#39;</span> <span class="o">+</span> <span class="n">original_comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport_data</span> <span class="o">=</span> <span class="n">TransportData</span><span class="p">(</span>
            <span class="n">shapeIndex</span><span class="o">=</span><span class="n">shape_index</span><span class="p">,</span>
            <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">dipoleMoment</span><span class="o">=</span><span class="p">(</span><span class="n">dipole_moment</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;De&#39;</span><span class="p">)),</span>
            <span class="n">polarizability</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span>
            <span class="n">rotrelaxcollnum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># rotational relaxation collision number at 298 K</span>
            <span class="n">comment</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="TSGuess"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess">[docs]</a><span class="k">class</span> <span class="nc">TSGuess</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TSGuess class</span>

<span class="sd">    The user can define xyz directly, and the default `method` will be &#39;User guess&#39;</span>
<span class="sd">    Alternatively, either ARC or the user can provide reactant/s and product/s geometries with a specified `method`</span>
<span class="sd">    `method` could be one of the following:</span>
<span class="sd">    - QST2 (not implemented)</span>
<span class="sd">    - DEGSM (not implemented)</span>
<span class="sd">    - NEB (not implemented)</span>
<span class="sd">    - Kinbot: requires the RMG family, only works for H,C,O,S (not implemented)</span>
<span class="sd">    - AutoTST</span>

<span class="sd">    Args:</span>
<span class="sd">        method (str, optional): The method/source used for the xyz guess.</span>
<span class="sd">        reactants_xyz (list, optional): A list of tuples, each containing:</span>
<span class="sd">                                        (reactant label, reactant geometry in string format).</span>
<span class="sd">        products_xyz (list, optional): A list of tuples, each containing:</span>
<span class="sd">                                       (product label, product geometry in string format).</span>
<span class="sd">        family (str, optional): The RMG family that corresponds to the reaction, if applicable.</span>
<span class="sd">        xyz (str, optional): The 3D coordinates guess.</span>
<span class="sd">        rmg_reaction (Reaction, optional): An RMG Reaction object.</span>
<span class="sd">        ts_dict (dict, optional): A dictionary to create this object from (used when restarting ARC).</span>
<span class="sd">        energy (float): Relative energy of all TS conformers in kJ/mol.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        xyz (str): The 3D coordinates guess.</span>
<span class="sd">        opt_xyz (str): The 3D coordinates after optimization at the ts_guesses level.</span>
<span class="sd">        method (str): The method/source used for the xyz guess.</span>
<span class="sd">        reactants_xyz (list): A list of tuples, each containing:</span>
<span class="sd">                              (reactant label, reactant geometry in string format).</span>
<span class="sd">        products_xyz (list): A list of tuples, each containing:</span>
<span class="sd">                             (product label, product geometry in string format).</span>
<span class="sd">        family (str): The RMG family that corresponds to the reaction, if applicable.</span>
<span class="sd">        rmg_reaction (Reaction): An RMG Reaction object.</span>
<span class="sd">        t0 (float): Initial time of spawning the guess job.</span>
<span class="sd">        execution_time (str): Overall execution time for the TS guess method.</span>
<span class="sd">        success (bool): Whether the TS guess method succeeded in generating an XYZ guess or not.</span>
<span class="sd">        energy (float): Relative energy of all TS conformers in kJ/mol.</span>
<span class="sd">        index (int): An index corresponding to the conformer jobs spawned for each TSGuess object.</span>
<span class="sd">                     Assigned only if self.success is ``True``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reactants_xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">products_xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">rmg_reaction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ts_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">ts_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Reading from a dictionary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ts_dict</span><span class="o">=</span><span class="n">ts_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Not reading from a dictionary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opt_xyz</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>  <span class="c1"># populates self.xyz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;user guess&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;user guess&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;If no method is specified, an xyz guess must be given&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reactants_xyz</span> <span class="o">=</span> <span class="n">reactants_xyz</span> <span class="k">if</span> <span class="n">reactants_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">products_xyz</span> <span class="o">=</span> <span class="n">products_xyz</span> <span class="k">if</span> <span class="n">products_xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span> <span class="o">=</span> <span class="n">rmg_reaction</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">family</span>
            <span class="c1"># if self.family is None and self.method.lower() in [&#39;kinbot&#39;, &#39;autotst&#39;]:</span>
            <span class="c1">#     raise TSError(&#39;No family specified for method {0}&#39;.format(self.method))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s1">&#39;user guess&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">or</span> <span class="s1">&#39;autotst&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;user guess&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">tsm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">tsm</span> <span class="ow">in</span> <span class="n">default_ts_methods</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;Unrecognized method. Should be either </span><span class="si">{0}</span><span class="s1">. Got: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                          <span class="p">[</span><span class="s1">&#39;User guess&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">default_ts_methods</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">))</span>

<div class="viewcode-block" id="TSGuess.as_dict"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A helper function for dumping this object as a dictionary in a YAML file for restarting ARC&quot;&quot;&quot;</span>
        <span class="n">ts_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
        <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;execution_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">:</span>
            <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants_xyz</span><span class="p">:</span>
            <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;reactants_xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactants_xyz</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">products_xyz</span><span class="p">:</span>
            <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;products_xyz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">products_xyz</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rxn_string</span> <span class="o">=</span> <span class="s1">&#39; &lt;=&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">spc</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">toSMILES</span><span class="p">()</span> <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">]),</span>
                                      <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">spc</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">toSMILES</span><span class="p">()</span> <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span><span class="o">.</span><span class="n">products</span><span class="p">])])</span>
            <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;rmg_reaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rxn_string</span>
        <span class="k">return</span> <span class="n">ts_dict</span></div>

<div class="viewcode-block" id="TSGuess.from_dict"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.from_dict">[docs]</a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper function for loading this object from a dictionary in a YAML file for restarting ARC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;t0&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;index&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;xyz&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_xyz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>  <span class="c1"># re-populates self.xyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;success&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;energy&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;execution_time&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;execution_time&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;method&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="s1">&#39;user guess&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;user guess&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;If no method is specified, an xyz guess must be given&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactants_xyz</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;reactants_xyz&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;reactants_xyz&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">products_xyz</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;products_xyz&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;products_xyz&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;family&#39;</span> <span class="ow">in</span> <span class="n">ts_dict</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;kinbot&#39;</span><span class="p">,</span> <span class="s1">&#39;autotst&#39;</span><span class="p">]:</span>
            <span class="c1"># raise TSError(&#39;No family specified for method {0}&#39;.format(self.method))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No family specified for method </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;rmg_reaction&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ts_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rxn_string</span> <span class="o">=</span> <span class="n">ts_dict</span><span class="p">[</span><span class="s1">&#39;rmg_reaction&#39;</span><span class="p">]</span>
            <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span>
            <span class="n">arrow</span> <span class="o">=</span> <span class="s1">&#39; &lt;=&gt; &#39;</span>
            <span class="k">if</span> <span class="n">arrow</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rxn_string</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;Could not read the reaction string. Expected to find &quot; &lt;=&gt; &quot;. &#39;</span>
                              <span class="s1">&#39;Got: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rxn_string</span><span class="p">))</span>
            <span class="n">sides</span> <span class="o">=</span> <span class="n">rxn_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
            <span class="n">reac</span> <span class="o">=</span> <span class="n">sides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">prod</span> <span class="o">=</span> <span class="n">sides</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">plus</span> <span class="ow">in</span> <span class="n">reac</span><span class="p">:</span>
                <span class="n">reac</span> <span class="o">=</span> <span class="n">reac</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">plus</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reac</span> <span class="o">=</span> <span class="p">[</span><span class="n">reac</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">plus</span> <span class="ow">in</span> <span class="n">prod</span><span class="p">:</span>
                <span class="n">prod</span> <span class="o">=</span> <span class="n">prod</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">plus</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prod</span> <span class="o">=</span> <span class="p">[</span><span class="n">prod</span><span class="p">]</span>
            <span class="n">reactants</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">products</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">reactant</span> <span class="ow">in</span> <span class="n">reac</span><span class="p">:</span>
                <span class="n">reactants</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Species</span><span class="p">()</span><span class="o">.</span><span class="n">fromSMILES</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">reactant</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">prod</span><span class="p">:</span>
                <span class="n">products</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Species</span><span class="p">()</span><span class="o">.</span><span class="n">fromSMILES</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">product</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">reactants</span><span class="o">=</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">)</span></div>

<div class="viewcode-block" id="TSGuess.execute_ts_guess_method"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.execute_ts_guess_method">[docs]</a>    <span class="k">def</span> <span class="nf">execute_ts_guess_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a TS guess method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;user guess&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;qst2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qst2</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;degsm&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">degsm</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;neb&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">neb</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;kinbot&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kinbot</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;autotst&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">autotst</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TSError</span><span class="p">(</span><span class="s1">&#39;Unrecognized method. Should be either </span><span class="si">{0}</span><span class="s1">. Got: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                          <span class="p">[</span><span class="s1">&#39;User guess&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">default_ts_methods</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">))</span></div>

<div class="viewcode-block" id="TSGuess.autotst"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.autotst">[docs]</a>    <span class="k">def</span> <span class="nf">autotst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine a TS guess using AutoTST for the following RMG families:</span>
<span class="sd">        Current supported families are:</span>
<span class="sd">        - H_Abstraction</span>
<span class="sd">        Near-future supported families might be:</span>
<span class="sd">        - Disproportionation</span>
<span class="sd">        - R_Addition_MultipleBond</span>
<span class="sd">        - intra_H_migration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;AutoTST requires an RMG Reaction object. Got: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span><span class="p">)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;H_Abstraction&#39;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;AutoTST currently only works for H_Abstraction. Got: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">atst</span><span class="o">.</span><span class="n">autotst</span><span class="p">(</span><span class="n">rmg_reaction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rmg_reaction</span><span class="p">,</span> <span class="n">reaction_family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">)</span></div>

<div class="viewcode-block" id="TSGuess.qst2"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.qst2">[docs]</a>    <span class="k">def</span> <span class="nf">qst2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine a TS guess using QST2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="TSGuess.degsm"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.degsm">[docs]</a>    <span class="k">def</span> <span class="nf">degsm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine a TS guess using DEGSM</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="TSGuess.neb"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.neb">[docs]</a>    <span class="k">def</span> <span class="nf">neb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine a TS guess using NEB</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="TSGuess.kinbot"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.kinbot">[docs]</a>    <span class="k">def</span> <span class="nf">kinbot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine a TS guess using Kinbot for RMG&#39;s unimolecular families</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="TSGuess.process_xyz"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.TSGuess.process_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">process_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If xyz represents a file path, parse it.</span>
<span class="sd">        Standardize the xyz format using converter.standardize_xyz_string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">parse_xyz_from_file</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">standardize_xyz_string</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="determine_occ"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.determine_occ">[docs]</a><span class="k">def</span> <span class="nf">determine_occ</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">charge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the number of occupied orbitals for an MRCI calculation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">electrons</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">xyz</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">electrons</span> <span class="o">+=</span> <span class="n">atom</span><span class="o">.</span><span class="n">number</span>
    <span class="n">electrons</span> <span class="o">-=</span> <span class="n">charge</span></div>


<div class="viewcode-block" id="nearly_equal"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.nearly_equal">[docs]</a><span class="k">def</span> <span class="nf">nearly_equal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sig_fig</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper function to determine whether two floats are nearly equal.</span>
<span class="sd">    Can be replaced by math.isclose in Py3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">sig_fig</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">sig_fig</span><span class="p">)</span></div>


<div class="viewcode-block" id="determine_rotor_symmetry"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.determine_rotor_symmetry">[docs]</a><span class="k">def</span> <span class="nf">determine_rotor_symmetry</span><span class="p">(</span><span class="n">rotor_path</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">pivots</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the rotor symmetry number from a potential energy scan.</span>
<span class="sd">    The *worst* resolution for each peak and valley is determined.</span>
<span class="sd">    The first criterion for a symmetric rotor is that the highest peak and the lowest peak must be within the</span>
<span class="sd">    worst peak resolution (and the same is checked for valleys).</span>
<span class="sd">    A second criterion for a symmetric rotor is that the highest and lowest peaks must be within 10% of</span>
<span class="sd">    the highest peak value. This is only applied if the highest peak is above 2 kJ/mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        rotor_path (str): The path to an ESS output rotor scan file.</span>
<span class="sd">        label (str): The species label (used for error messages).</span>
<span class="sd">        pivots (list): A list of two atom indices representing the torsion pivots.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The symmetry number (int) and the highest torsional energy barrier (float) in kJ/mol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">determine_qm_software</span><span class="p">(</span><span class="n">fullpath</span><span class="o">=</span><span class="n">rotor_path</span><span class="p">)</span>
    <span class="n">energies</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loadScanEnergies</span><span class="p">()</span>

    <span class="n">symmetry</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">max_e</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_e</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">0.10</span> <span class="o">*</span> <span class="n">max_e</span>  <span class="c1"># tolerance for the second criterion</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="n">max_e</span>
    <span class="n">min_e</span> <span class="o">=</span> <span class="n">energies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">energies</span><span class="p">):</span>
        <span class="c1"># sometimes the opt level and scan levels mismatch, causing the minimum to be close to 0 degrees, but not at 0</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">min_e</span><span class="p">:</span>
            <span class="n">min_e</span> <span class="o">=</span> <span class="n">e</span>
    <span class="n">peaks</span><span class="p">,</span> <span class="n">valleys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># the peaks and valleys of the scan</span>
    <span class="n">worst_peak_resolution</span><span class="p">,</span> <span class="n">worst_valley_resolution</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">energies</span><span class="p">):</span>
        <span class="c1"># identify peaks and valleys, and determine worst resolutions in the scan</span>
        <span class="n">ip1</span> <span class="o">=</span> <span class="n">cyclic_index_i_plus_1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">energies</span><span class="p">))</span>  <span class="c1"># i Plus 1</span>
        <span class="n">im1</span> <span class="o">=</span> <span class="n">cyclic_index_i_minus_1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>                <span class="c1"># i Minus 1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">]</span> <span class="o">==</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># If the first and last scan points have same energy, change im1</span>
            <span class="n">im1</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;im1: </span><span class="si">{0}</span><span class="s1">, ip1: </span><span class="si">{1}</span><span class="s1">, em1: </span><span class="si">{2}</span><span class="s1">, e: </span><span class="si">{3}</span><span class="s1">, ep1: </span><span class="si">{4}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">im1</span><span class="p">,</span> <span class="n">ip1</span><span class="p">,</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">],</span> <span class="n">e</span><span class="p">,</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]:</span>
            <span class="c1"># this is a local peak</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">diff</span> <span class="o">&gt;</span> <span class="n">worst_peak_resolution</span> <span class="k">for</span> <span class="n">diff</span> <span class="ow">in</span> <span class="p">[</span><span class="n">e</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">],</span> <span class="n">e</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]]]):</span>
                <span class="n">worst_peak_resolution</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">],</span> <span class="n">e</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">])</span>
            <span class="n">peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]:</span>
            <span class="c1"># this is a local valley</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">diff</span> <span class="o">&gt;</span> <span class="n">worst_valley_resolution</span> <span class="k">for</span> <span class="n">diff</span> <span class="ow">in</span> <span class="p">[</span><span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">]]):</span>
                <span class="n">worst_valley_resolution</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">energies</span><span class="p">[</span><span class="n">im1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="n">energies</span><span class="p">[</span><span class="n">ip1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">valleys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="c1"># The number of peaks and valley must always be the same (what goes up must come down), if it isn&#39;t then there&#39;s</span>
    <span class="c1"># something seriously wrong with the scan</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">valleys</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Rotor of species </span><span class="si">{0}</span><span class="s1"> between pivots </span><span class="si">{1}</span><span class="s1"> does not have the same number&#39;</span>
                     <span class="s1">&#39; of peaks (</span><span class="si">{2}</span><span class="s1">) and valleys (</span><span class="si">{3}</span><span class="s1">).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">pivots</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">peaks</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">valleys</span><span class="p">)))</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">peaks</span><span class="p">),</span> <span class="n">max_e</span> <span class="o">*</span> <span class="mf">0.001</span>  <span class="c1"># this works for CC(=O)[O]</span>
    <span class="n">min_peak</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
    <span class="n">max_peak</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
    <span class="n">min_valley</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">valleys</span><span class="p">)</span>
    <span class="n">max_valley</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">valleys</span><span class="p">)</span>
    <span class="c1"># Criterion 1: worst resolution</span>
    <span class="k">if</span> <span class="n">max_peak</span> <span class="o">-</span> <span class="n">min_peak</span> <span class="o">&gt;</span> <span class="n">worst_peak_resolution</span><span class="p">:</span>
        <span class="c1"># The rotor cannot be symmetric</span>
        <span class="n">symmetry</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;worst peak resolution criterion&#39;</span>
    <span class="k">elif</span> <span class="n">max_valley</span> <span class="o">-</span> <span class="n">min_valley</span> <span class="o">&gt;</span> <span class="n">worst_valley_resolution</span><span class="p">:</span>
        <span class="c1"># The rotor cannot be symmetric</span>
        <span class="n">symmetry</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;worst valley resolution criterion&#39;</span>
    <span class="c1"># Criterion 2: 10% * max_peak</span>
    <span class="k">elif</span> <span class="n">max_peak</span> <span class="o">-</span> <span class="n">min_peak</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="c1"># The rotor cannot be symmetric</span>
        <span class="n">symmetry</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;10</span><span class="si">% o</span><span class="s1">f the maximum peak criterion&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We declare this rotor as symmetric and the symmetry number is the number of peaks (and valleys)</span>
        <span class="n">symmetry</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="s1">&#39;number of peaks and valleys, all within the determined resolution criteria&#39;</span>
    <span class="k">if</span> <span class="n">symmetry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Determined symmetry number </span><span class="si">{0}</span><span class="s1"> for rotor of species </span><span class="si">{1}</span><span class="s1"> between pivots </span><span class="si">{2}</span><span class="s1">;&#39;</span>
                    <span class="s1">&#39; you should make sure this makes sense&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">symmetry</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">pivots</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Determined a symmetry number of </span><span class="si">{0}</span><span class="s1"> for rotor of species </span><span class="si">{1}</span><span class="s1"> between pivots </span><span class="si">{2}</span><span class="s1">&#39;</span>
                    <span class="s1">&#39; based on the </span><span class="si">{3}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">symmetry</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">pivots</span><span class="p">,</span> <span class="n">reason</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">symmetry</span><span class="p">,</span> <span class="n">max_e</span> <span class="o">*</span> <span class="mf">0.001</span>  <span class="c1"># max_e in kJ/mol</span></div>


<div class="viewcode-block" id="cyclic_index_i_plus_1"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.cyclic_index_i_plus_1">[docs]</a><span class="k">def</span> <span class="nf">cyclic_index_i_plus_1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A helper function for cyclic indexing rotor scans&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="k">else</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="cyclic_index_i_minus_1"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.cyclic_index_i_minus_1">[docs]</a><span class="k">def</span> <span class="nf">cyclic_index_i_minus_1</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A helper function for cyclic indexing rotor scans&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="determine_rotor_type"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.determine_rotor_type">[docs]</a><span class="k">def</span> <span class="nf">determine_rotor_type</span><span class="p">(</span><span class="n">rotor_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine whether this rotor should be treated as a HinderedRotor of a FreeRotor</span>
<span class="sd">    according to it&#39;s maximum peak</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">determine_qm_software</span><span class="p">(</span><span class="n">fullpath</span><span class="o">=</span><span class="n">rotor_path</span><span class="p">)</span>
    <span class="n">energies</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loadScanEnergies</span><span class="p">()</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span>  <span class="c1"># convert to kJ/mol (Arkane used SI)</span>
    <span class="k">return</span> <span class="s1">&#39;FreeRotor&#39;</span> <span class="k">if</span> <span class="n">max_val</span> <span class="o">&lt;</span> <span class="n">minimum_barrier</span> <span class="k">else</span> <span class="s1">&#39;HinderedRotor&#39;</span></div>


<div class="viewcode-block" id="enumerate_bonds"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.enumerate_bonds">[docs]</a><span class="k">def</span> <span class="nf">enumerate_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper function for calling Molecule.enumerate_bonds.</span>
<span class="sd">    First, get the Kekulized molecule (get the Kekule version with alternating single and double bonds if the molecule</span>
<span class="sd">    is aromatic), since we don&#39;t have implementation for aromatic bond additivity corrections.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (Molecule): The 2D graph representation of the molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Keys are bond types (elements and bond order symbol), values are number of occurrences per bond type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol_list</span> <span class="o">=</span> <span class="n">generate_kekule_structure</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mol_list</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">enumerate_bonds</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span><span class="o">.</span><span class="n">enumerate_bonds</span><span class="p">()</span></div>


<div class="viewcode-block" id="check_xyz"><a class="viewcode-back" href="../../../api/species.html#arc.species.species.check_xyz">[docs]</a><span class="k">def</span> <span class="nf">check_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">multiplicity</span><span class="p">,</span> <span class="n">charge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks a string-format coordinates for electronic consistency with the spin multiplicity and charge.</span>

<span class="sd">    Args:</span>
<span class="sd">        xyz (str): The species coordinates.</span>
<span class="sd">        multiplicity (int): The species spin multiplicity.</span>
<span class="sd">        charge (int): The species net charge.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: Whether the input arguments are all in agreement. True if they are.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">get_xyz_matrix</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">electrons</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">element_symbol</span> <span class="ow">in</span> <span class="n">symbol_by_number</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">element_symbol</span><span class="p">:</span>
                <span class="n">electrons</span> <span class="o">+=</span> <span class="n">number</span>
                <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">electrons</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
    <span class="n">electrons</span> <span class="o">-=</span> <span class="n">charge</span>
    <span class="k">if</span> <span class="n">electrons</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">^</span> <span class="n">multiplicity</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span></div>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Alon Grinberg Dana

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>